<!DOCTYPE html>
<html lang="en">
<head>
    <title>Hands-on 3: Intro to Scripting</title>
    <link rel="stylesheet" href="tutorial.css">
    <link rel="stylesheet" href="prism.css">
    <meta charset="UTF-8">
    <head-content></head-content>
</head>
    
<body>
    <mode-select></mode-select>
    <div class="page-container">
        <site-header subtitle="3: Intro to Scripting" /></site-header>   
        
        <div class="linkBox-container">
            <div class="linkBox">
                <a href="#launchingScripts">Launching Scripts</a>
                <a href="#functions">Functions</a>
                <a href="#parameters">Parameters</a>
                <a href="#userInterface">User Interface</a>
                <a href="#doLoop">The <code>do</code> loop</a>
                <a href="#conclusion">Conclusion</a>
                <a href="#finalScripts">Final Scripts</a>
                <site-nav></site-nav>
            </div>
          </div>

        <p>
            In this tutorial, we'll be creating a fully-functional terminal application that can let us check some useful system information 
            in one place. We'll be pulling from previous lessons and adding some new functionality as we go.
        </p>
        <p>
            Full code can be found near the bottom of this page for the <a href="#systemInfops1">PowerShell script</a>. I have commented the 
            complete code as thoroughly as felt necessary to let it be a stand-alone document, but we'll still go through everything step by
            step as we move along.
        </p>
        <h2 id="launchingScripts">Launching Scripts</h2>
        <p>
            Very frustratingly, Microsoft has decided to make PowerShell scripts pretty difficult to run! This is a security feature to keep 
            less adept computer users from accidentally running malicious scripts that have been slipped to them, but unfortunately it has a
            pretty giant flaw -- we can simply use batch scripts (from the old MS-DOS days) to manually bypass all of that security.
        </p>
        <p>
            This does require having TWO files, though. We can have a batch that that we can just click on and that will allow us to get over
            this little hurdle without too much issue.            
        </p>
        <p>
            However, this is <strong>NOT</strong> a batch scripting tutorial, so I am simply going to paste the code that works here, and you can find the 
            full <code><a href="#launcherBat">launcher.bat</a></code> at the bottom of the page. Paste the following into a new <code>*.bat</code>
            file, being sure to modify the <code>$scriptPath</code> variable to reflect the correct script name to run all future practice 
            applications without needing to modify system-wide permissions.
        </p>
        <div class="vscode-snippet">
            <pre class="language-batch" data-prismjs-copy="Copy"><code id="ho301"></code></pre>
        </div>

        <h2 id="functions">Getting Funky with Functions</h2>
        <p>
            Functions are basically used to store code that we know we'll be running repeatedly. We can create them very easily and call on them later
            do a long or complex task without repeating the code again. In this tutorial, we'll pass one through a new type of <code><em>loop</em></code>
            that we have not yet seen, the <code>do</code> loop.
        </p>
        <p>
            Without further ado, let's get started. Fire up your editor of choice and save a new file as <code>systemInfo.ps1</code>. After that, enter the 
            following code to begin our first function:
        </p>
        <div class="vscode-snippet">
            <pre class="language-powershell" data-prismjs-copy="Copy"><code id="ho302"></code></pre>
        </div>
        <div class="tutorial-hint">
            <h4><code>return</code>-ing Data</h4>
            <p>
                When a function is called as a variable assignment (in this script,we'll be running <code>$computerCollection = Get-UpdatedSysInfo</code> at the beginning), you need to `return` data to it - in this case, we are returning the new collection we generated by running this function.
            </p>
            <p>
                In this case, since we aren't setting it as a variable, <code>return</code> simply gives us the output in the terminal window.
            </p>
        </div>
        <p>
            When you run that script, you should get some output that looks familiar from the last lesson.
        </p>
        <pre class="console-output" id="ho303"></pre>
        <h2 id="parameters">Parameters</h2>
        <p>
            Now that we have a function that collects all that data, we want something that allows us to pick which pieces of data we want to see.
        </p>
        <p>
            Let's begin by removing the <code>$computerCollection</code> debugging line, since we can see that our code does in fact work, and let's add another new function to our script. Add this directly below the existing script:
        </p>
        <div class="vscode-snippet">
            <pre class="language-powershell" data-prismjs-copy="Copy"><code id="ho304"></code></pre>
        </div>
        <div class="tutorial-hint">
            <h4><code>param</code>-eter Blocks</h4>
            <p>
                The <code>param</code> code block you see at the beginning of the function tells the script that in order to use the function, the user must supply additional information. Unlike functions themselves, these are contained within parentheses ("(" and ")"). Different parameters that can be supplied are separated by commas (",").
            </p>
            <p>
                In our script, we are looking for two parameters: <code>$infoType</code>, which we assign the same names as the data properties in our new collection, and <code>$dataSource</code>, which is the collection we want to pull from. We probably don't NEED to have a parameter for <code>$dataSource</code>, but if we set it as a parameter now, we can easily add other data sources down the road if we decide to expand the scope of this application.
            </p>
        </div>
        <p>
            At the end of running the script now, you should get output in your terminal that looks like this:
        </p>
        <pre class="console-output"><span style="color: yellow;">=== WindowsVersion ===</span>
Data updated at 5/5/2025 10:18:57 AM
            
Windows Version: Microsoft Windows 11 Pro
            
Press any key to return to main screen</pre>

        <p>Once again, let's remove the last line that calls the <code>Show-Information</code> function, and then move on to the next step.</p>
        <h2 id="userInterface">User Interface</h2>
        <p>
            Now that we know how to collect the data, let's move on to actually creating an interface to deal with it. For now, we'll keep it simple. Add the following code to the end of script, directly after defining the <code>Show-Information</code> function:
        </p>
        <div class="vscode-snippet">
            <pre class="language-powershell" data-prismjs-copy="Copy"><code id="ho305"></code></pre>
        </div>
        <p>
            And now when we run our script, we'll get an interface asking us which piece of information we want. For now, we just have a basic <code>if</code> statement that exits the application, no matter what we do (we'll <code>do</code> that next). You'll see output like this:
        </p>
        <pre class="console-output"><span style="color: green;">================ System Information Viewer ================</span>
<span style="color: black;background-color: white;">Data collected on 5/5/2025 10:42:20 AM</span>

<span style="color: yellow;">Please select an option:</span>

0. Update system information
1. Windows Version
2. Current User
3. Computer Name
4. CPU Information
5. Time Zone
<span style="color: red;">q. Exit</span>

Enter your choice (0-5 or q): q
<span style="color: red;">Quitting application</span></pre>

        <div class="tutorial-hint">
            <h4>Formatting terminal text</h4>
            <p>
                We could have simply had a single "Write-Host" command to type out all of that information, but you need to be careful with formatting. Since text in a "Write-Host" command is considered pre-formatted, going to a new line in one command will require everything to be laid out differently.
            </p>
            <p>
                Code that looks like this:
            </p>
                <pre>>    Write-Host "Testing
>    Testing Testing 1-2"</pre>
            <p>
                Will generate:
            </p>
                <pre>Testing
        Testing Testing 1-2</pre>
            <p>
                Because of the tab gap on the second line. I usually find it's best to simply state new lines when you know there will be one.
            </p>
        </div>

        <h2 id="doLoop">Do the <code>do</code> (loop)</h2>        
        <p>
            Remove everything after the <code>Show-SystemInformation</code> function. We'll be replacing that logic with entirely new logic with the following code:
        </p>
        <div class="vscode-snippet">
            <pre class="language-powershell" data-prismjs-copy="Copy"><code id="ho306"></code></pre>
        </div>
        <div class="tutorial-hint">
            <h4>What <code>do</code>?</h4>
            <p>
                We saw a ForEach-Object loop in earlier lessons - here's another kind. Instead of going through every property of a supplied collection, a "do" loop simply repeats until it is broken.
            </p>
            <p>
                So here we begin our <code>do</code> loop - it will continue to run <code>while</code> "q" is not selected to exit the program. Once the user selects "q", the program terminates with a parting message.
            </p>
            <h4><code>switch</code>ing it up</h4>
            <p>
                Previously, we used an <code>if</code> statement to decide which selection does what. However, when we have multiple options to choose from, we can use a <code>switch</code> statement instead. It works much like an <code>if</code> statement, but instead of looping throughy every single argument using <code>elseif</code> and <code>else</code> statements, it can simply select which action to take from a pre-defined index, which is what we are doing here.
            </p>
        </div>
        <p>
            Now when you run your script, you'll see the same interface as before, but all of its functions should work. The full code with more in-depth commenting can be found below the <a href="#conclusion">Conclusion</a> section below, including the <code>ps1</code> and <code>bat</code> launcher file.
        </p>
        <h2 id="conclusion">Conclusion</h2>
        <p>There was a lot to touch on today and this tutorial is likely going to be needed to refer back to from time-to-time, but we have finally written a tiny utility in PowerShell! Now we should have a decent grasp on the following:</p>
        <ol>
            <li>How (and why) to launch a PowerShell script from a Batch file.</li>
            <li>How to write and use functions to collect and store information for later use.</li>
            <li>Adding and using parameters in functions.</li>
            <li>Creating basic text-based user interfaces and using <code>Read-Host</code> to get user input.</li>
            <li>Implementing <code>do</code> loops to create functional programs.</li>
            <li>Using <code>switch</code> statements when appropriate, rather than <code>if</code> statements.</li>
        </ol>

        <!-- Full files below here. -->
        <h2 id="finalScripts">Final Scripts</h2>
        <p>
            <a href="#systemInfops1">systemInfo.ps1</a>
            <a href="#launcherBat">launcher.bat</a>

        </p>
            <h3 class="winScript" id="systemInfops1"><span class="scriptFile">systemInfo.ps1</span></h3>
        <div class="vscode-snippet" >
            <pre class="language-powershell"  data-prismjs-copy="Copy"><code id="ho3ps101"></code></pre>
        </div>
        <h3 class="winScript" id="launcherBat"><span class="scriptFile">launcher.bat</span></h3>
        <div class="vscode-snippet">
            <pre class="language-batch"  data-prismjs-copy="Copy"><code id="ho3bat1"></code></pre>
        </div>
    </div>
    <!-- Stop any editing here -->
    <a href="#top" class="back-to-top" id="backToTop">↑</a>
    <script src="js/tutorial.js"></script>
    <script src="js/ho3.js"></script>
    <script src="js/prism.js"></script>

</body>
</html>